typedef set<'A>
typedef stage = LS_IN_ACL{} | LS_OUT_ACL{}
function __builtin_2string (x: 'X): string
for (ls in Logical_Switch) { Flow ( ls, LS_IN_ACL{}, 0, "1", "next;" ); Flow ( ls, LS_OUT_ACL{}, 0, "1", "next;" ) }
for (ls in Logical_Switch if ls.has_stateful_acl) { Flow ( ls, LS_IN_ACL{}, 1, "ip && (!ct.est || (ct.est && ct_label.blocked))", "{ reg0[1] = 1; next; }" ); Flow ( ls, LS_OUT_ACL{}, 1, "ip && (!ct.est || (ct.est && ct_label.blocked))", "{ reg0[1] = 1; next; }" ); Flow ( ls, LS_IN_ACL{}, 65535, "ct.inv || (ct.est && ct.rpl && ct_label.blocked)", "{ drop; }" ); Flow ( ls, LS_OUT_ACL{}, 65535, "ct.inv || (ct.est && ct.rpl && ct_label.blocked)", "{ drop; };" ); Flow ( ls, LS_IN_ACL{}, 65535, "(ct.est && !ct.rel && !ct.new && !ct.inv && ct.rpl && !ct_label.blocked)", "{ next; }" ); Flow ( ls, LS_OUT_ACL{}, 65535, "(ct.est && !ct.rel && !ct.new && !ct.inv && ct.rpl && !ct_label.blocked)", "{ next; }" ); Flow ( ls, LS_IN_ACL{}, 65535, "!ct.est && ct.rel && !ct.new && !ct.inv && !ct_label.blocked", "{ next; }" ); Flow ( ls, LS_OUT_ACL{}, 65535, "!ct.est && ct.rel && !ct.new && !ct.inv && !ct_label.blocked", "{ next; }" ); Flow ( ls, LS_IN_ACL{}, 65535, "nd", "{ next; }" ); Flow ( ls, LS_OUT_ACL{}, 65535, "nd", "{ next; }" ) }
